<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="userMapper">
	
	<select id="getUser" resultMap="UserResultMap" resultType="User">
		SELECT id, nickname, email, auth, g.no, g.name
			FROM user u, group_setting g
		WHERE id = #{id} and u.group_no = g.no
	</select>
	
	<select id="getUserPass" resultType="string">
		SELECT pass FROM user
			WHERE id = #{id}
	</select>

	<select id="getAdmin" resultMap="UserResultMap" resultType="User">
		SELECT id, pass, nickname, email FROM user
			WHERE auth = 'Y'
	</select>

	<update id="updateUser" parameterType="HashMap">
		UPDATE user
		    <set>
				<if test="user.id != null and !user.id.equals('')">
			 		id = #{user.id},
				</if>
			    <if test="user.pass != null and !user.pass.equals('')">
					pass = #{user.pass},
				</if>
				<if test="user.nickname != null and !user.nickname.equals('')">
					nickname = #{user.nickname},
				</if>
				<if test="user.email != null and !user.email.equals('')">
					email = #{user.email},
				</if>
				<if test="user.groupNo != null and !user.groupNo.equals('')">
					no = #{user.no},
				</if>
			</set>
			<where>
				<if test="userOrigId != null and !userOrigId.equals('')">
					id = #{userOrigId}
				</if>
				<if test="userOrigId == null or userOrigId.equals('')">
					AND id = #{user.id}
				</if>
			</where>
	</update>
	
	<resultMap type="User" id="UserResultMap">
		<id property="id" column="id" />
		<result property="pass" column="pass" />
		<result property="nickname" column="nickname" />
		<result property="email" column="email" />
		<result property="auth" column="auth" />
		<result property="groupNo" column="group_no" />
		<result property="groupName" column="group_name" />
	</resultMap>
	
</mapper>